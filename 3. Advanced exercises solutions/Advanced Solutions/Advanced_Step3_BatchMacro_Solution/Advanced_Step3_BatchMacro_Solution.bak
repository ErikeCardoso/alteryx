<?xml version="1.0"?>
<AlteryxDocument yxmdVer="10.0">
  <Nodes>
    <Node ToolID="7">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="438" y="246" width="264" height="132" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Output</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="5">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="54" y="246" width="264" height="132" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Input</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="2">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="54" y="54" width="564" height="156" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text><![CDATA[A bank is looking to calculate customer retention rate month over month. The denominator in the calculation are all of the accounts open 24 months prior to the start of the month. For example, for June 2013, the denominator would be the total number of accounts open between June 1, 2011 through May 31, 2013. The numerator will be total number of accounts closed in June 2013 or between June 1, 2013 through June 30, 2013. 

For the exercise, create a batch macro that calculates the retention rate for May, June, July and August. 
]]></Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="3">
      <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
        <Position x="90" y="270" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <NumRows value="10" />
          <Fields>
            <Field name="RecordID" />
            <Field name="Open Date" />
            <Field name="Close Date" />
          </Fields>
          <Data>
            <r>
              <c>1</c>
              <c>April 03, 2013</c>
              <c>May 06, 2013</c>
            </r>
            <r>
              <c>2</c>
              <c>April 14, 2013</c>
              <c />
            </r>
            <r>
              <c>3</c>
              <c>May 03, 2013</c>
              <c>July 18, 2013</c>
            </r>
            <r>
              <c>4</c>
              <c>May 24, 2013</c>
              <c>June 12, 2013</c>
            </r>
            <r>
              <c>5</c>
              <c>June 13, 2013</c>
              <c>July 10, 2013</c>
            </r>
            <r>
              <c>6</c>
              <c>June 26, 2013</c>
              <c />
            </r>
            <r>
              <c>7</c>
              <c>July 04, 2013</c>
              <c />
            </r>
            <r>
              <c>8</c>
              <c>July 15, 2013</c>
              <c>August 09, 2013</c>
            </r>
            <r>
              <c>9</c>
              <c>July 21, 2013</c>
              <c />
            </r>
            <r>
              <c>10</c>
              <c>August 13, 2013</c>
              <c />
            </r>
          </Data>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
    </Node>
    <Node ToolID="4">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="222" y="270" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\ProgramData\Alteryx\Engine\Engine_1580_05f3c4f279934b8d8feb3c75d36e3e01_\Engine_8104_ed66c93db1c0490994cfa6318cc09fb7_.yxdb</TempFile>
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Table</DefaultTab>
              <Hints />
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="6">
      <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
        <Position x="474" y="282" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <NumRows value="5" />
          <Fields>
            <Field name="Open" />
            <Field name="Close" />
            <Field name="%" />
            <Field name="Start of Month" />
          </Fields>
          <Data>
            <r>
              <c>2</c>
              <c>1</c>
              <c>0.5</c>
              <c>2013-05-01</c>
            </r>
            <r>
              <c>3</c>
              <c>1</c>
              <c>0.333333333333333</c>
              <c>2013-06-01</c>
            </r>
            <r>
              <c>4</c>
              <c>2</c>
              <c>0.5</c>
              <c>2013-07-01</c>
            </r>
            <r>
              <c>5</c>
              <c>1</c>
              <c>0.2</c>
              <c>2013-08-01</c>
            </r>
          </Data>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
    </Node>
    <Node ToolID="8">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="618" y="282" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\ProgramData\Alteryx\Engine\Engine_1580_05f3c4f279934b8d8feb3c75d36e3e01_\Engine_8104_4ad2ece8896a4362b791e16502f139ce_.yxdb</TempFile>
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Table</DefaultTab>
              <Hints />
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="12">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DateTime.DateTime">
        <Position x="294" y="498" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <IsFrom value="False" />
          <InputFieldName>Close Date</InputFieldName>
          <Format>Month dd, yyyy</Format>
          <OutputFieldName>DateTime_Close_Date</OutputFieldName>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Convert Close Date From:
Month dd, yyyy</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDateTime" />
    </Node>
    <Node ToolID="11">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DateTime.DateTime">
        <Position x="186" y="498" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <IsFrom value="False" />
          <InputFieldName>Open Date</InputFieldName>
          <Format>Month dd, yyyy</Format>
          <OutputFieldName>DateTime_Start_Date</OutputFieldName>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Convert Open Date From:
Month dd, yyyy</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDateTime" />
    </Node>
    <Node ToolID="15">
      <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
        <Position x="402" y="498" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <OrderChanged value="False" />
          <SelectFields>
            <SelectField field="RecordID" selected="False" />
            <SelectField field="Open Date" selected="False" />
            <SelectField field="Close Date" selected="False" />
            <SelectField field="DateTime_Start_Date" selected="True" rename="Open_Date" />
            <SelectField field="DateTime_Close_Date" selected="True" rename="Close_Date" />
            <SelectField field="*Unknown" selected="True" />
          </SelectFields>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
    </Node>
    <Node ToolID="16">
      <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
        <Position x="402" y="402" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <NumRows value="4" />
          <Fields>
            <Field name="Month" />
          </Fields>
          <Data>
            <r>
              <c>2013-05-01</c>
            </r>
            <r>
              <c>2013-06-01</c>
            </r>
            <r>
              <c>2013-07-01</c>
            </r>
            <r>
              <c>2013-08-01</c>
            </r>
          </Data>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
    </Node>
    <Node ToolID="18">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="630" y="486" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\ProgramData\Alteryx\Engine\Engine_1580_05f3c4f279934b8d8feb3c75d36e3e01_\Engine_8104_733ad92f41bb4ea8b0327d4b017aa6e9_.yxdb</TempFile>
          <Layout>
            <View1>
              <Hints>
                <Table />
              </Hints>
            </View1>
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="19">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="102" y="630" width="336" height="108" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text><![CDATA[Leverage the Date Time tools to convert the dates formatted as a String into DateTime values. 

The primarly reason is because we need to leverage the dates to help calculate how many accounts are open/closed during a specific time period. ]]></Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="20">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="522" y="558" width="124" height="60" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>The batch macro where the Control Parameter is Month</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="21">
      <GuiSettings>
        <Position x="522" y="486" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Value name="BatchMacroGroupBy" />
          <Value name="Input.Input"><![CDATA[Open Date=Open_Date
Close Date=Close_Date
]]></Value>
          <Value name="ControlParams"><![CDATA[Control Parameter (4)=Month
]]></Value>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output14">
          <RecordInfo>
            <Field name="Start of Month" source="Summarize: GroupBy - Month (BatchMacro) (BatchMacro) (BatchMacro) (BatchMacro)" type="Date" />
            <Field name="Open" source="Summarize: Sum - Open (BatchMacro) (BatchMacro) (BatchMacro) (BatchMacro)" type="Int64" />
            <Field name="Close" source="Summarize: Sum - Closed (BatchMacro) (BatchMacro) (BatchMacro) (BatchMacro)" type="Int64" />
            <Field name="%" source="Formula: [Close]/[Open] (BatchMacro) (BatchMacro) (BatchMacro) (BatchMacro)" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings Macro="Batch Macro.yxmc" />
    </Node>
  </Nodes>
  <Connections>
    <Connection>
      <Origin ToolID="3" Connection="Output" />
      <Destination ToolID="4" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="3" Connection="Output" />
      <Destination ToolID="11" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="6" Connection="Output" />
      <Destination ToolID="8" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="12" Connection="Output" />
      <Destination ToolID="15" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="11" Connection="Output" />
      <Destination ToolID="12" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="15" Connection="Output" />
      <Destination ToolID="21" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="16" Connection="Output" />
      <Destination ToolID="21" Connection="Control" />
    </Connection>
    <Connection>
      <Origin ToolID="21" Connection="Output14" />
      <Destination ToolID="18" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>Advanced_Step3_BatchMacro_Solution</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
    </MetaInfo>
    <Events>
      <Enabled value="True" />
    </Events>
  </Properties>
</AlteryxDocument>